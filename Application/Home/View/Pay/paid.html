<div class="container" style="margin-top: 81px">

    <form role="form" id="checkname" method="get" action="<{:U('Pay/paidsearch')}>">
        <div class="row">


            <div class="col-xs-12 col-sm-1 col-sm-offset-1" style="margin-bottom: 14px">
                <select class="selectpicker" name="query_type">
                    <option value="4"
                    <?php if(isset($query['type']) && $query['type']=='4'){echo 'selected="selected"';}?>>按客户姓名</option>
                    <option value="5"
                    <?php if(isset($query['type']) && $query['type']=='5'){echo 'selected="selected"';}?>>按距离今日 X
                    天范围内</option>
                    <option value="1"
                    <?php if(isset($query['type']) && $query['type']=='1'){echo 'selected="selected"';}?>
                    >按具体日期(例:2017-10-07)</option>
                    <option value="2"
                    <?php if(isset($query['type']) && $query['type']=='2'){echo 'selected="selected"';}?> >按支票号
                    (无需完整支票号)</option>
                    <option value="3"
                    <?php if(isset($query['type']) && $query['type']=='3'){echo 'selected="selected"';}?>>按备注
                    (多条件请用and隔开)</option>
                    <!--<option value="7" <?php if(isset($query['type']) && $query['type']=='7'){echo 'selected="selected"';}?>>按Lot查询</option>-->
                    <option value="8"
                    <?php if(isset($query['type']) && $query['type']=='8'){echo 'selected="selected"';}?>
                    >按收款人查询</option>
                </select>
            </div>

            <div class="col-xs-5 col-sm-2 col-sm-offset-3 col-md-offset-2">
                <div class="form-group">
                    <input type="text" name="query"
                           value="<?php if(isset($query['query']) && $query['query']){echo $query['query'];}?>"
                           class="form-control" placeholder="请输入搜索的信息">
                </div>
            </div>

            <div class="col-xs-3 col-sm-1">
                <button type="submit" class="btn btn-default"><span class="fa fa-search-minus"></span> 查询已支付</button>
            </div>

        </div>

        <div class="row" style="margin-top: 14px">

            <div class="col-xs-6 col-sm-offset-1 col-sm-2">
                <a href="<{:U('Pay/paidsearch',array('query_type'=>6))}>"
                   class="btn <?php if($nouser){echo 'btn-danger';}else{echo 'btn-default';}?>"><span class="badge"><{$nouser}></span>
                    缺少客户账单</a>
            </div>

            <div class="col-xs-6 text-right col-sm-8">
                <a href="<{:U('Pay/paid')}>" class="btn btn-primary"><span class="fa fa-check-circle"></span> 全部已支付</a>
            </div>

        </div>

    </form>
</div>

<!--已录入编辑-->
<div class="container" style="margin-top: 30px;margin-bottom: 100px">

    <div class="row">
        <?php if(isset($query)){?>
        <div class="col-sm-12 col-xs-12" style="margin-top: -10px;margin-bottom: 25px;margin-left: 95px">
            <div style="background-color: #2f73bf;color:white;border-radius: 5px;height: 20px;font-size: 12px;line-height: 20px;text-align: center;width: 200px">
                系统本次为您查到 <?=count($payment)?> 个记录</span> </div>
        </div>
        <?php } ?>
        <div class="col-sm-10 col-sm-offset-1 col-xs-12">
            <div class="table-responsive table-paid" style="display: none">
                <table class="table table-bordered table-hover">
                    <thead>
                    <tr>
                        <th>姓名</th>
                        <th>支付账号</th>
                        <th>支票号</th>
                        <th>收款人</th>
                        <th>支付金额</th>
                        <th>支付时间</th>
                        <th>备注说明</th>
                        <th>操作</th>
                    </tr>
                    </thead>
                    <tbody>

                    <?php $k=1;?>
                    <foreach name="payment" item="p">
                        <?php
                   if($k%2==1){
                   echo '<tr>';
                        }else{
                        echo '
                        <tr>';
                            }
                            $k++;
                            ?>
                            <td style="width: 150px"><{$p.name}></td>
                            <td style="width: 120px;font-size:11px"><{$p.account}></td>
                            <td style="width: 80px"><{$p.receipt}></td>
                            <td style="width: 150px"><P
                                    style="width: 150px;text-overflow: ellipsis;white-space: nowrap;overflow: hidden">
                                <{$p.receiver}></P>
                            </td>
                            <td style="width: 130px;font-size:12px"><strong><span class="fa fa-usd"></span>
                                <{$p.amount}></strong></td>
                            <td style="width: 140px;font-size:11px"><{$p.regtime|date="Y-m-d",###}></td>
                            <td style="width: 340px;font-size:11px"><{$p.payfor}></td>
                            <td style="width: 250px"><a style="margin-bottom:8px"
                                                        href="<{:U('Pay/paidedit',array('id'=>$p['id'],'cat'=>$p['cat']))}>"
                                                        class="btn btn-sm btn-primary"><span class="fa fa-edit"></span>
                                编辑</a> <a style="margin-bottom:8px"
                                          href="<{:U('Pay/deletepaid',array('id'=>$p['id'],'cat'=>$p['cat']))}>"
                                          class="delete btn btn-sm btn-default"> <span class="fa fa-trash"></span>
                                撤销</a></td>
                        </tr>
                    </foreach>

                    </tbody>

                </table>

                <nav>
                    <ul class="pagination">
                        <{$page}>
                    </ul>
                </nav>
            </div>
        </div>
    </div>

</div>


<script src="__PUBLIC__/js/jquery1.11.1.min.js"></script>
<script src="__PUBLIC__/dist/js/bootstrap.min.js"></script>
<script src="__PUBLIC__/vendor/bootstrap-validator/bootstrapValidator.min.js"></script>
<script src="__PUBLIC__/dist-select/js/bootstrap-select.js"></script>
<script src="__PUBLIC__/js/bootbox.min.js"></script>
<script>
    $(function () {
        $('.table-paid').fadeIn(1500);
    })
</script>
<script>
    $('.navbar-nav li:eq(3)').addClass('active');
    $('#checkname').bootstrapValidator({
        fields: {
            query: {
                validators: {
                    notEmpty: {
                        message: '请填写搜索信息'
                    },
                    stringLength: {
                        min: 1,
                        max: 40,
                        message: '请输入3-40个字符'
                    }
                }
            }
        }
    });
</script>
<script>
    $(".delete").click(function (event) {
        var cur = this;
        event.preventDefault();
        bootbox.confirm({

            message: "温馨提示:一经撤销不可恢复喔...",
            buttons: {
                cancel: {
                    label: '<i class="fa fa-times"></i> 取消'
                },
                confirm: {
                    label: '<i class="fa fa-check"></i> 确认'
                }
            },
            callback: function (result) { /* result is a boolean; true = OK, false = Cancel*/
                if (result) {
                    window.location.href = $(cur).attr("href");
                }
            }
        });
    });


</script>

